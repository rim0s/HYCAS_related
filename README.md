# HYCAS_相关脚本与工具

HYCAS 是一款超市业务管理系统，包含门店收银终端程序、采购、物流、商品、价格、促销、会员、线上接口等多种功能模块。

多年前，我在连锁超市负责信息部门技术工作。为了解决技术人员水平不一、各部门系统模块使用问题、应急处理等需求，我选择使用无需依赖第三方程序的批处理脚本来解决实际问题。

离职后，我已将之前公司同事（包括技术人员和门店人员）可能用到的程序、脚本和资料分享在微云（weiyun.com），并持续续费维持存储空间。现在我将部分程序和脚本迁移至此，微云空间可能不再续费。

---

## 📁 文件说明

### 1. `前台备分收银流水文件并覆盖空库.bat`
- **功能**：备份收银流水文件并清空数据库。
- **说明**：已移除代码中的联系信息。

---

### 2. `临时解决外卖平台导致实物流水报错问题$`
- **功能**：解决外卖平台引起的实物流水报错问题。
- **说明**：
  - 已移除包含密码的 `crt2.dll` 文件。
  - 主脚本 `双击我.bat` 为一键执行脚本。
  - 使用对称加密算法对主脚本和数据库连接密码进行加密，执行时动态解密并清理中间文件。
  - 包含 OpenSSL Windows 版本及相关 C 文件，便于在不适配环境下重新编译。
  - 加密主要为了防止误操作导致文件篡改，并非为了保密。
- **编写时间**：约 2019–2020 年。

---

### 3. `A_安装数据库.BAT`
- **功能**：一键安装 MS SQL Server 2000 SP4。
- **说明**：
  - 针对 Windows 10 系统安装旧版数据库时需进行的额外操作，封装为批处理脚本。
  - 脚本会判断操作系统版本，自动获取权限并执行相应操作。
  - 原压缩包包含安装文件与 SP4 补丁，此处仅保留脚本核心逻辑。
- **编写时间**：约 2019–2020 年。

---

### 4. `testprint2`
- **功能**：单独打印与第三方供货商对账用的销售凭据。
- **说明**：
  - 基于业务系统表结构和业务逻辑编写的简单打印程序。
  - 代码中的敏感信息已替换为假数据。
  - 原使用 v141 库，现已不受支持。
  - 注：新版程序通过逆向获取数据库连接密码算法，可直接读取本地业务系统密码文件，为保护前公司利益，该版本不会公开。

---

### 5. `WL_PROJECT`
包含三个程序和一个安装包打包脚本：

#### `A_Priceboard_tool`
- **功能**：价签位置调整工具。
- **说明**：通过打印测试页调整价签元素坐标，快速适配不同打印机与纸张。

#### `MFCApplication1`
- **功能**：价签版式切换工具。
- **说明**：管理多种价签配置文件，可快速切换并提示重启门店管理程序。

#### `WLHYUpdater`
- **功能**：从公司服务器下载并更新程序的批量管理工具。
- **说明**：用于大批量程序更新，仅作尝试性开发。

#### 安装包打包脚本
- 用于制作上述工具的安装包。

**编写时间**：约 2019 年。

---

### 6. `SpayPCsetup`
- **功能**：自动安装并配置第三方收款端 SpayPC。
- **说明**：
  - 用于批量部署，自动修改安装后的配置文件，替代手动设置。
  - 通常在业务推广期间快速完成全部门店的远程安装。
  - 通过编写自动化安装向导和配置程序，将原本需要数天的工作压缩至一夜完成，减轻技术人员与门店人员的压力。

---

## 💡 使用说明
- 部分脚本依赖系统环境（如 Windows 批处理、OpenSSL 等），请确保执行环境符合要求。
- 涉及数据库操作的脚本需谨慎使用，建议在测试环境中验证。
- 部分代码已脱敏，如有需要可参考逻辑自行适配。

---

## 📝 备注
- 脚本多为解决具体业务问题而编写，代码结构较为简单，注重实用性与快速部署。
- 如遇到兼容性问题，可尝试根据代码注释或逻辑进行调试。
- 为保护前公司及相关系统利益，部分敏感逻辑与代码未公开。

---

> 这些脚本与工具曾用于支持超市日常运营与技术支持，希望能为类似场景提供参考或帮助。
