# HYCAS_related

HYCAS是一款超市的业务管理系统。其中包括了门店收银终端程序，采购，物流，商品、价格、促销、会员、线上接口等非常繁多的功能模块。
我很多年前在连锁超市工作时候负责信息部门的技术工作。工作过程为了解决技术人员水平参差不齐，各部门使用软件系统各个模块问题，应急问题等，选择使用不需要依赖不需要第三方程序就能运行的批处理程序的方法来解决一些实际问题。
我离职以后已经将之前公司同事，无论是技术人员还是门店人员，能用到的程序、脚本、和资料都放在weiyun.com进行了共享。这么多年为了维持共享可用一直每月续费维持存储空间。现在我把一些程序和脚本放到这里，可能weiyun就不再续费了。


1.前台备分收银流水文件并覆盖空库.bat    
功能是字面意思，我已经把代码中当时为了给其他技术人员看的联系方式信息去除了。

2.临时解决外卖平台导致实物流水报错问题$  
功能是字面意思，请忽略错别字。我在上传前去除了保存有密码的crt2.dll文件。主脚本"双击我.bat"是一键执行。程序使用了对称算法对包含语句的主脚本内容，和操作数据库所需的密码进行了加密。双击我.bat会对主要逻辑脚本解密，主要逻辑脚本在适当时候对数据库SQL脚本和连接密码进行解密。执行后对中间文件进行清理。为了能使用对陈算法我找到了一个版本的openssl 的windows包。这也是为什么这个功能的批处理会包含文件夹和这么多文件其实这些头文件和c文件不是必须的，但是这个程序是要给各个技术人员去分别在各自负责的门店去执行的，为了在出现不适配的情况下能有进行编译来补救的机会，我保留了这些文件。我对内容进行加密当时并不是为了保密，而是防止误操作导致篡改了文件以至于操作数据库这样的危险操作产生无法补救的后果。
我的脚本都很槽，因为我其实并不擅长写脚本。只是为了解决问题而去了解和使用的。因为windows的batch和linux的shell脚本都是系统自带直接就能使用，不需要准备环境和找第三方程序，除非有必须使用的第三方程序功能的时候。这个好像是我19年～20年写的。

3.A_安装数据库.BAT                   
当时会有需要安装古老的 MS SQL SERVER 2K SP4 的情况。最开始没有什么问题，但是后来随着Windows10 系统的出现。很多主机硬件上已经不支持安装Windows 7 操作系统了。Windows 10安装微软的 MSSQLSERVER 2K时候需要进行一些额外操作才可以顺利安装和使用，比较费操作，于是参考需要进行的操作。将其使用批处理脚本来实现，于是顺便完成了一键安装数据库的批处理。其实为了方便我是将2K的安装文件与sp4文件和脚本放到了一个文件夹中压缩打包给技术人员使用的。但是核心逻辑都在这个脚本里，部分我没有上传的部分其实并不重要，尤其是包含自动应答信息和数据库密码的iss文件。程序会判断操作系统版本，自动获取权限和根据系统不同来判断需要作的工作。这个好像是我19年～20年写的。

4.testprint2                        
用于单独打印与第三方供货商对账用的销售凭据,了解了业务系统表结构和业务逻辑后编写了一个简单的程序用于打印凭据。敏感信息已经在VS2026打开后使用假数据代替了。v141库也已经不受支持了。代码没什么价值，只是解决了业务部门的一个问题。
我对公司业务程序加密数据库连接密码的算法进行了逆向并还原，因为是对称算法，我使用C++使用该算法写了个加密/解密函数，用以在其他程序中调用，包括更完善版本的testprint2。新版本直接读取本地业务系统存储的密码文件获取链接信息后可以用于连接业务系统。为了确保前公司和业务系统公司的利益，这个版本我不会发布。

5.WL_PROJECT                        
里面有3个程序和一个安装包打包脚本。 A_Priceboard_tool 是价签位置调整工具。HYCAS的门店管理软件有个使用率极高的模块功能是打印价签，他会读取固定的几个配置文件中的价签元素的位置参数，这个位置参数就是纸张的坐标。根据纸张不同，印刷的价签版式以及打印机不同而不同。偏偏没有个可视化的编辑软件。经测试，不同打印机，或同一品牌型号但不同批次的打印机对于同一个元素的坐标会不同，所以可视化就很难了，需要花费大量时间研究底层原理。为了快速解决，编写了一个价签位置调整工具。根据印刷的（通常接近A4规格）的价签纸上打印一次到三次单个价签，也就是经过三次整版相对位置的调整即可确定该门店的价签位置，也就是配置文件中的各元素的坐标。前提是有一个整版样式都与某版价签样式相符的配置文件，才可以通过软件调整整体相对偏移的方式调整合适的打印位置。好在我在总部，可以与运营相关部门沟通，在新版价配送到门店前获得样板进而编写出与印刷版式相符的配置文件。
随着门店中的价签种类变多，（促销专用，会员专用，普通的，平时囤积但没用完的古老版本1版本2版本3）门店想要从一种价签切换另一种价签的配置文件来达到可以适配打印另一种版式规格，MFCApplication1 这个程序就是用于切换价签的。好多年过去了我已经记不起来名字了，好像是叫价签版式切换工具。它本身会把各种默认的价签版式配置文件拷贝到对应目录，并且保留已经调整好的配置文件。然后快速的从各种价签配置之间切换。因为切换配置文件只有重启门店管理程序shop.exe才能重新读取配置，所以程序会询问是否关闭门店管理程序。当时只是为了解决问题，进行的实验性尝试，所以没有去认真想程序的名字。
WLHYUpdater是通过从公司服务器上下载程序并应用的一个工具，主要为了大批量的更新管理。这只是一次尝试。这组程序好像是2019的。同样公司的网络地址已经被我替换成假的了。

6.SpayPCsetup
SpayPC是一个第三方收款的商家收款端。在微信和支付宝在争夺零售门店在线支付占有率的时候，这个工具背后的资方提供了更低一些的费率和返点。为了快速推进该程序的安装和部署，写了这个程序对程序安装后的配置文件进行修改，以代替手工在软件界面的费时操作。以此为基础，可以进行远程批量安装。
这种业务推动的新软件安装的工作通常决策到执行只有两三天时间，看完业务人员演示安装和使用过程，拿到程序安装包。以及各门店各自账号后，一边要将账号发给各自门店，另一边通知门店安装周期以进行配合。可能早上拿到程序，晚上开始就组织技术人员进行远程安装。白天这段时间就要对安装程序是否能自动化安装做研究，安装后的设置如何保存固定进行研究。根据原理编写软件安装向导的自动化应答文件，写出像这样的自动设置一类的程序。于是就quick and dirty.很多次这样的工作，都是因为会使用编写并制作程序/脚本，让可能需要一周或是两三天完成的工作一晚上就全部完成。能让我的技术人员早点完成工作下班，门店人员能正常进行他们的工作，减少压力和学习成本是那时候的一个重要目标。









